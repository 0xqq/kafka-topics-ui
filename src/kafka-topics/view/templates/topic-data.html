<!--
    selectedTabNnumber
    search.$
    onTabChanges('topic')
    getPartitions / partitions (?) >> topic.partitions
-->
<div ng-show="rows.length==0">
    Topic is empty
</div>
<div style="background-color:#fff;" ng-cloak layout-margin  ng-hide="rows.length==0">

    <div ng-show="showAdvanced">
        <div class="partitionSelection" style="background:#eee;padding:10px">
            Select partition:<br />
            <span ng-repeat="partition in topic.partitions | orderBy : 'partition' ">
              <label class="checkbox">
              {{partition.partition}}
                <input type="radio" name="partition" ng-checked="exists(partition.partition, selectedPartitions)"
                       ng-click="toggle(partition.partition, selectedPartitions)"
                />
              </label>
            </span><br />
            <input placeholder="Set offset*" type="number" ng-model="offset" />
            <md-button ng-click="assignPartitions(selectedPartitions, offset)">GO</md-button> <br />
            <small style="color:#999"><i>*If left empty, sets offset to the earliest value</i></small>

        </div>
    </div>

    <md-tabs style="padding:0" md-dynamic-height md-border-bottom md-selected="selectedTabNnumber">
        <div layout="row">
            <input  ng-model="searchMessages" ng-change="dataFlatTableCtrl.refreshData()"  ng-model-options="{ debounce: 500 }" placeholder="filter" style="width: 300px;margin: 7px; line-height: 30px;">

            <md-button ng-click="toggleAdvanced()">{{showOrHideAdvanced}}</md-button>


            <md-button
                    ng-hide="topic.totalMessages == 0"
                    ng-click="showDownloadDiv = !showDownloadDiv"
                    aria-label="Download data"
                    aria-hidden="false">
                <i class="fa fa-download" ng-show="!showDownloadDiv" aria-hidden="true" style="color:#333"></i>
                <i class="fa fa-close" ng-show="showDownloadDiv" aria-hidden="true" style="color:#333"></i>
            </md-button>
        </div>


        <!--TODO Why don't we handle keyType as well? -->
        <md-tab label="Topic" ng-click="onTabChanges('topic', cluster)" ng-if="!hideTab">
            <tree-view data="rows" topic="topic" partitions="" search="searchMessages"></tree-view>
        </md-tab>

        <md-tab label="Table" ng-click="onTabChanges('table', cluster)" ng-if="!hideTab">
            <flat-view data="rows" topic="topic" partitions="" search="searchMessages"></flat-view>
        </md-tab>

        <md-tab label="Raw Data" ng-click="onTabChanges('rawdata', cluster)" >
            <raw-view data="rows"  topic="topic" topicType="topic.valueType"></raw-view>
        </md-tab>

    </md-tabs>

    <div class="downloadDiv" ng-show="showDownloadDiv">
        <h4>Download Options</h4>
        <ul>
            <li>
                <div class="checkbox checkbox-info">
                    <input id="checkbox1" type="checkbox" checked="checked" class="fxhdr">
                    <label for="checkbox1">Download Avro encoded file</label>
                </div>
            </li>
            <li>
                <div class="checkbox checkbox-success">
                    <input id="checkbox4" type="checkbox" class="open-close">
                    <label for="checkbox4"> Download only filtered data</label>
                </div>
            </li>
        </ul>
        <md-button style="float:right"  download="true"
                   ng-click="downloadData(topic.topicName, rows)"
                   aria-label="Download data"
                   aria-hidden="false">
            <i class="fa fa-download" aria-hidden="true" style="color:#333"></i>
        </md-button>

    </div>
</div>